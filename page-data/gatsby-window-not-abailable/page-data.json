{"componentChunkName":"component---src-pages-blog-post-js","path":"/gatsby-window-not-abailable/","result":{"data":{"site":{"siteMetadata":{"title":"Huiy's Blog"}},"markdownRemark":{"id":"d4fe0b90-e925-5b77-8423-cd3a910d1379","excerpt":"다크모드를 적용하고, 로컬에서 잘 돌아가는 것을 확인한 다음 배포를 하려고 했는데 이런 에러가 발생했습니다.  에러 메시지를 읽어보니 window…","html":"<p>다크모드를 적용하고, 로컬에서 잘 돌아가는 것을 확인한 다음 배포를 하려고 했는데 이런 에러가 발생했습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 550px; overflow: hidden!important; border-radius: 8px!important; margin-left: 0!important; box-shadow: 0 0 10px rgb(210, 210, 210);\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3b6e410ab151fb2ba7e0f4354d77fbb9/076ca/windowisnot.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25.362318840579707%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA4UlEQVR42m2Q6W6DMBCEeYlwGDDBF75IIJVb9f0fbLLrKJVa9cd4fex+mnHjtw0xBGyOaoykgETVe49A9zlnpJRq3fe9Vu5zzsEYg43muZe1risaXpTW0MYS1GFVCstKWpYqfjdGV1lrK0hKibZt0XXdj/jc9z0BeVBpfJSC76+CdM8w4QX3wUOIAZfL72EeFEJgGIYq3r/PjSIHV3ZJDg1BOHL0luJ6ihehtSJHM+Z5xjRNGMex6g37q2ZZJEZ5haCYJu8o5ROPx4nbLeM8DxzHncCe/soSXNc/4/js8j/gEwM6i4PxhqM+AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"windowisnot\"\n        title=\"\"\n        src=\"/static/3b6e410ab151fb2ba7e0f4354d77fbb9/dd45a/windowisnot.png\"\n        srcset=\"/static/3b6e410ab151fb2ba7e0f4354d77fbb9/948cf/windowisnot.png 138w,\n/static/3b6e410ab151fb2ba7e0f4354d77fbb9/6b2ea/windowisnot.png 275w,\n/static/3b6e410ab151fb2ba7e0f4354d77fbb9/dd45a/windowisnot.png 550w,\n/static/3b6e410ab151fb2ba7e0f4354d77fbb9/d4c13/windowisnot.png 825w,\n/static/3b6e410ab151fb2ba7e0f4354d77fbb9/076ca/windowisnot.png 914w\"\n        sizes=\"(max-width: 550px) 100vw, 550px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>에러 메시지를 읽어보니 window객체가 없다는 말이었습니다.</p>\n<h3>원인</h3>\n<p>자바스크립트에는 전역 객체가 존재합니다. 전역 객체란 모든 객체의 유일한 최상위 객체를 의미하며 일반적으로 Brower-side에서는 window , Server-side(Node.js)에서는 global 객체를 의미합니다.\nNode.js에서는 window라는 객체가 존재하지 않아, 빌드시 초기 Gatsby가 서버사이드 렌더링 할 때 window객체를 참조할 수 없어 생기는 문제였습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 550px; overflow: hidden!important; border-radius: 8px!important; margin-left: 0!important; box-shadow: 0 0 10px rgb(210, 210, 210);\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/1a8f2d899531b6802d2aca381f90b4da/d2a60/error.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.68115942028986%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABeElEQVR42pVR226rMBDM/39YLj1SouYhOm2VEDAXG9tgA0kKhM4ZO1LfD9Job97Z2WW12+1wOByw3W5xOp2wXq/x9vYHx+MRm80G+/0e//OtPr8+SbjH+/Edl8sFaZoiSZLof3z8xfl8xjzPeD6fEcuyRIRczEc7YZ5GLKyvOtejdzfYukXTtHCtgzUWjWVsG7SMa6UhK/ULrS2869D5Hr4x6BsNZxTuvSdhO2Bo7xj8/UVA0kASLeG9Jzr0XUcSxs6TyGGapl/V0/RSG1fW2kAbQutIqKSKioLaWtUoiwqWeaskVCHQWkObQcsqqq1rjaqsCBnJVyLLkecFrskVwU9TQT+FEDmyTCC9ZtG/sB5iIQokzIWeUMv4viBhylo/DFRYcyKVaE4q8vI1lQpDg5J1VKCLEuoqYFi39BtpYKSD4S1t2JBvTVnyhj1v2NxQszGsLKWKNqwaVjf8OWGgYd1WJM9lxPQYMX8vGL9HjOOI6faI+FkW/AMjc1lJvXqm2QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"error\"\n        title=\"\"\n        src=\"/static/1a8f2d899531b6802d2aca381f90b4da/dd45a/error.png\"\n        srcset=\"/static/1a8f2d899531b6802d2aca381f90b4da/948cf/error.png 138w,\n/static/1a8f2d899531b6802d2aca381f90b4da/6b2ea/error.png 275w,\n/static/1a8f2d899531b6802d2aca381f90b4da/dd45a/error.png 550w,\n/static/1a8f2d899531b6802d2aca381f90b4da/d2a60/error.png 807w\"\n        sizes=\"(max-width: 550px) 100vw, 550px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p><a href=\"https://www.gatsbyjs.com/docs/debugging-html-builds/\">공식문서</a>를 읽어보니 웹페이지를 일단 빌드하기만 하면 이후 브라우저 환경에서는 window 객체를 참조할 수 있으니 일단은 빌드될 수 있도록만 해주면 될 것 같았습니다.</p>\n<h3>해결</h3>\n<h4>1. window가 정의되어 있는지 확인</h4>\n<deckgo-highlight-code language=\"javascript\"  >\n          <code slot=\"code\">const isBrowser = typeof window !== &quot;undefined&quot;\nif (isBrowser) {\n    window.localStorage.getItem(&quot;isLoggedIn&quot;) === &quot;true&quot;\n}</code>\n        </deckgo-highlight-code>\n<p>이런식으로 현재 window 객체가 존재하는지 확인한 후, 존재하는 경우에만 window 객체를 참조할 수 있도록 해주면 됩니다.</p>\n<h4>2. useEffect 사용하기</h4>\n<deckgo-highlight-code language=\"javascript\"  >\n          <code slot=\"code\">useEffect(() =&gt; {\n    window.localStorage.getItem(&quot;isLoggedIn&quot;) === &quot;true&quot;\n  }\n);</code>\n        </deckgo-highlight-code>\n<p><code class=\"language-text\">useEffect</code>는 DOM형성 후에 실행이 되는 hook입니다. 즉 브라우저에서만 코드가 실행됩니다. 이렇게 하면 초기 빌드 시 <code class=\"language-text\">useEffect</code> 내부 코드는 실행되지 않으므로 <code class=\"language-text\">useEffect</code> 내부로 에러가 발생하는 코드를 옮겨주면 해결됩니다.</p>","tableOfContents":"<ul>\n<li>\n<p><a href=\"#%EC%9B%90%EC%9D%B8\">원인</a></p>\n</li>\n<li>\n<p><a href=\"#%ED%95%B4%EA%B2%B0\">해결</a></p>\n<ul>\n<li><a href=\"#1-window%EA%B0%80-%EC%A0%95%EC%9D%98%EB%90%98%EC%96%B4-%EC%9E%88%EB%8A%94%EC%A7%80-%ED%99%95%EC%9D%B8\">1. window가 정의되어 있는지 확인</a></li>\n<li><a href=\"#2-useeffect-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0\">2. useEffect 사용하기</a></li>\n</ul>\n</li>\n</ul>","frontmatter":{"title":"\"window\" is not available 에러 해결","date":"July 29, 2023","description":"Gatsby 블로그를 배포하다가 만난 에러를 해결했습니다.","category":"블로그","icon":"🔧"}},"previous":{"fields":{"slug":"/darkmode/"},"frontmatter":{"title":"Gatsby 블로그에 다크모드 적용하기"}},"next":{"fields":{"slug":"/alteration-detective/"},"frontmatter":{"title":"첫 사이드 프로젝트 진행기"}}},"pageContext":{"id":"d4fe0b90-e925-5b77-8423-cd3a910d1379","previousPostId":"15c962c6-13bb-578e-8d27-78cae8ad51e4","nextPostId":"e36dd6cc-6e8f-554c-bf85-fe68d2be47a6"}},"staticQueryHashes":["2841359383"],"slicesMap":{}}